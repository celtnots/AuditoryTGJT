<!DOCTYPE html>

<html>

<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title></title>
  <link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">
  <style>
    body {
      font-family: Gill Sans, sans-serif;
    }

    #explanation {
      border: 1px solid #000;
      width: 50%;
      height: 60%;
      margin: 20px;
      padding: 8px;
      margin-top: 40px;
    }

    #w3-container {
      cursor: pointer;
    }

    #myProgress {
      width: 80%;
      background-color: #ddd;
      align: left;
    }

    #myBar {
      width: 0%;
      height: 25px;
      background-color: #4CAF50;
      line-height: 25px;
      color: white;
    }


    p {
      text-align: center;
      font-family: Gill Sans;
      font-size: 11px;
      color: #424743;
    }

    h4.ex1 {
      margin: 15px;
      font-family: Gill Sans;
    }


    .item {
      margin: auto;
    }

    .slidecontainer {
      width: 50%;
    }

    .slider {
      -webkit-appearance: none;
      width: 100%;
      height: 10px;
      border-radius: 5px;
      background: #d3d3d3;
      outline: none;
      opacity: 0.7;
      -webkit-transition: .2s;
      transition: opacity .2s;
    }

    .slider:hover {
      opacity: 1;
    }

    .slider::-webkit-slider-thumb {
      -webkit-appearance: none;
      appearance: none;
      width: 25px;
      height: 25px;
      border-radius: 50%;
      background: #4CAF50;
      cursor: pointer;
    }

    .slider::-moz-range-thumb {
      width: 25px;
      height: 25px;
      border-radius: 50%;
      background: #4CAF50;
      cursor: pointer;
    }


    /* The Modal (background) */
    .modal {
      display: none;
      /* Hidden by default */
      position: fixed;
      /* Stay in place */
      z-index: 1;
      /* Sit on top */
      padding-top: 200px;
      /* Location of the box */
      left: 0;
      top: 0;
      width: 100%;
      /* Full width */
      height: 100%;
      /* Full height */
      align: center;
      overflow: auto;
      /* Enable scroll if needed */
      background-color: rgb(0, 0, 0);
      /* Fallback color */
      background-color: rgba(0, 0, 0, 0.4);
      /* Black w/ opacity */
    }

    /* Modal Content */
    .modal-content {
      background-color: #fefefe;
      font-size: 20px;
      margin: auto;
      padding: 20px;
      border: 1px solid #888;
      width: 50%;
    }

    /* The Close Button */
    .close {
      color: #aaaaaa;
      float: right;
      font-size: 28px;
      font-weight: bold;
    }

    .close:hover,
    .close:focus {
      color: #000;
      text-decoration: none;
      cursor: pointer;
    }

    .scroll {
      background-color: #f2eddf;
      width: 100%;
      height: 300px;
      overflow: auto;
      text-align: justify;
      padding: 10px;
      float: left;
    }
  </style>
</head>

<body>

  <div id="myModal" class="modal">

    <!-- Modal content -->
    <div class="modal-content">
      <span class="close">&times;</span>
      <div id="modalContent">Some text in the Modal..</div>
    </div>

  </div>


  <div id="Frame1" style="display: block">
    <center>
      <h4 class="ex1">Before you click CONTINUE, click the blue button to test your sound. <br>If you don't hear anything, check your computer's controls.</h4>
      <div>
        <input type="image" id="TestSoundButton" src="testsound0001.png" width="75" height="75" alt="TestSoundButton" draggable="false" onclick="testSound()">
        <BR>
      </div><br>
      <h4>
        <form>
          <label for="fname">Please enter <b>your name</b> for this test:</label>
          <input type="text" id="fname" name="fname" maxlength="40"><br><br>
          <!--How are we preventing malicious code here?-->
          <label for="NSRadio">Do you consider yourself a NATIVE SPEAKER of English?</label><br>
          <input type="radio" id="NS" name="NSRadio" value=1> Yes&nbsp;&nbsp;&nbsp;
          <input type="radio" id="NNS" name="NSRadio" value=2> No
          <BR>
        </form>
      </h4>
      <br>
    </center>
  </div>


  <div id="Frame2" style="display: none" class="item">
    <center>
      <h4 class="ex1">In this test, you are going to hear some sentences in English.<br>
        Some are correct and some are incorrect.<br>
        After each sentence stops, click CORRECT or INCORRECT
        <b>as fast as you can!</b>

      </h4>
    </center>
  </div>


  <div id="Frame2.5" style="display: none" class="item">
    <center>
      <div class="w3-row w3-border">
        <div class="w3-container w3-half w3-red" id="IC" style="cursor: pointer">
          <br>
          <image src="incorrect0001.png" width="100" alt="Incorrect" draggable="false" style="float:right">
            <!-- <input type="image" src="incorrect0001.png" width="100" alt="Incorrect" draggable="false" onclick="buttonClicked(0)"> -->
            <br>
            <h2>INCORRECT</h2><br>
        </div>
        <div class="w3-container w3-half w3-green" id="C" style="cursor: pointer">
          <br>
          <image src="correct0001.png" width="100" alt="Correct" draggable="false" style="float:right">
            <!-- <input type="image" src="correct0001.png" width="100" alt="Correct" draggable="false" onclick="buttonClicked(1)"> -->
            <br>
            <h2>CORRECT</h2><br>
        </div>
      </div>
  </div>


  <div id="Frame3" style="display: none" class="item">
    <center>
      <h4 class="ex1">First, we're going to check your reaction speed.<br>
        Click START. &nbsp; You will hear a beep.<br>
        When it stops, click EITHER BUTTON as fast as you can!</h4>
    </center>
    <br>
  </div>


  <div id="Frame3.5" style="display: none" class="item">
    <center>
      <br><br>
      <div class="w3-row w3-border">
        <div class="w3-container w3-grey" id="START" style="cursor: pointer">
          <h2>START</h2>
        </div>
      </div>
    </center>
  </div>


  <div id="Frame4" style="display: block" class="item">
    <center>
      <div class="w3-row w3-border">
        <div class="w3-container w3-grey" id="CONTINUE" style="cursor: pointer">
          <h2>CONTINUE</h2>
        </div>
      </div>
    </center>
  </div>


  <div id="Frame6" style="display: none" class="item">
    <center>
      <h4 class="ex1">After you decide, use the slider say how confident you are about your answer.</h4>
      <div id="ConfidenceSlider" class="slidecontainer">
        <p style="text-align:left; ">
          NOT CONFIDENT
          <span style="float:right">
            VERY CONFIDENT
          </span>
        </p>
        <p>
          <input type="range" min="0" max="100" value="50" class="slider" id="myRange2">
        <p>
          <span id="demo2"></span>%
        </p>
      </div>
    </center>
  </div>


  <div id="Frame7" style="display: none" class="item">
    <br>
    <br>
    <center>
      <span id="RTreport" style="border:solid 1px red">
        <font size=3px>Your reaction time was: <span id="RTdemo"></span> milliseconds.</font>
      </span>
    </center>
  </div>


  <div id="Frame8" style="display: none" class="item">
    <br>
    <br>
    <br>
    <center>
      <div id="myProgress">
        <div id="myBar"></div>

      </div>
      <span id="prog"></span>
    </center>
  </div>


  <div id="Frame9" style="display: none" class="item">
    <center>
      <h4 class="ex1">OK! Are you ready?<br>
        You'll hear each sentence ONE TIME ONLY. <br>
        After each, answer <b>as fast as you can!</b>
      </h4>
    </center>
  </div>


  <div id="Frame10" style="display: none">
    <center>
      <br>
      <div id="Rtreport" style="border:solid 1px blue">
        <font size=5px>Your score is <span id="totalScore"></span> <br>
          <span id="feedback">Congratulations!</span>
        </font><br>
        <font size=3px>Click on a sentence in the box below to see an explanation or hear it again.</font>
      </div>
    </center>
    <br>
    <div class="scroll">(Scroll down inside this box to see all of the sentences.)<br>
      <span id="1" onclick="showExplanation(0)"></span><br>
      <span id="2" onclick="showExplanation(1)"></span><br>
      <span id="3" onclick="showExplanation(2)"></span><br>
      <span id="4" onclick="showExplanation(3)"></span><br>
      <span id="5" onclick="showExplanation(4)"></span><br>
      <span id="6" onclick="showExplanation(5)"></span><br>
      <span id="7" onclick="showExplanation(6)"></span><br>
      <span id="8" onclick="showExplanation(7)"></span><br>
      <span id="9" onclick="showExplanation(8)"></span><br>
      <span id="10" onclick="showExplanation(9)"></span><br>
      <span id="11" onclick="showExplanation(10)"></span><br>
      <span id="12" onclick="showExplanation(11)"></span><br>
      <span id="13" onclick="showExplanation(12)"></span><br>
      <span id="14" onclick="showExplanation(13)"></span><br>
      <span id="15" onclick="showExplanation(14)"></span><br>
      <span id="16" onclick="showExplanation(15)"></span><br>
      <span id="17" onclick="showExplanation(16)"></span><br>
      <span id="18" onclick="showExplanation(17)"></span><br>
      <span id="19" onclick="showExplanation(18)"></span><br>
      <span id="20" onclick="showExplanation(19)"></span><br>
      <span id="21" onclick="showExplanation(20)"></span><br>
      <span id="22" onclick="showExplanation(21)"></span><br>
      <span id="23" onclick="showExplanation(22)"></span><br>
      <span id="24" onclick="showExplanation(23)"></span><br>
      <span id="25" onclick="showExplanation(24)"></span><br>
      <span id="26" onclick="showExplanation(25)"></span><br>
      <span id="27" onclick="showExplanation(26)"></span><br>

    </div>

    <center>
      <div id="explanation">(Please click on a sentence in the box above to see an explanation or hear it again.)</div>
      Click to hear the sentence again. <br><input type="image" id="playagain" src="play.png" width="75" height="75" alt="playagainButton" draggable="false" onclick="playItAgain()">

    </center>

  </div>

  <script>
    //set variables
    var i = 0,
      again = new Audio(), //player for listening to sentences again in the last stage
      audio = new Audio(), //the sentences audio player
      beepaudio = new Audio(), //the RT audio player
      beep = new Audio(), //the sound test audio player
      sentenceStr = "", //the variable for the name of the item
      strType = "beep", //whether it's beep or real sentences; set to beep at the start
      audiopaths = "", //string to complete beep audio path
      strUser = "", //users name
      gotWrong = []; //array of items user gets wrong in the test
      files = [], //array for all sentence data; from JSON file
      beepfiles = [], //array for RT beep files
      selectedSentence = 50, //which sentence the user clicks on in the final stage; set to 50 so it is not undefined or 0
      clickedTime = 0, //end timer
      createdTime = 0, //start timer
      reactionTime = 0, //difference between them
      clickedButton = 0, //whether user clickd C or IC
      strStatus = 0, //whether Native of Non-native
      appState = 1, //which stage we are in
      score = 0, //whether the user got the item correct or not
      runningTotal = 0, //the user's total score for the test


      // Initialize the audio players
      window.addEventListener("load", initAudioPlayer("beep")); //load the test sounds
    window.addEventListener("load", initAudioPlayer("sentences"));


    //FUNCTIONS

    function report() { //send data to the DB

        var xhttp = new XMLHttpRequest();
        xhttp.open("POST", "response.php", true);
        xhttp.setRequestHeader('Content-type', 'application/x-www-form-urlencoded; charset=UTF-8');
        xhttp.onreadystatechange = function() {
          if (this.readyState == 4 && this.status == 200) {
            // Response
            var response = this.responseText;
            // console.log(response);
          }
        };
        var data = {
          "UserName": strUser,
          "sentenceID": sentenceStr,
          "elapsedTime": reactionTime*1000,
          "answer": clickedButton,
          "AnswerScore": score,
          "status": strStatus,
          "Confidence": slider.value
        };
        xhttp.send(JSON.stringify( data ));
    }

    function initAudioPlayer(strType) {
      if (strType === "beep") {
        audiopaths = "TestSounds/"
        beepfiles = [
          audiopaths + "test1.mp3",
          audiopaths + "test2.mp3",
          audiopaths + "test3.mp3"
        ];
        //set audio source to files array
        beepaudio.src = beepfiles[i];
        beepaudio.volume = 0.1;
      }

      if (strType === "sentences") { //get JSON data and fill the files array
        var oXHR = window.XMLHttpRequest ? new XMLHttpRequest() : new ActiveXObject('Microsoft.XMLHTTP');

        function reportStatus() {
          if (oXHR.readyState == 4) // Request completed.
            showTheList(this.responseText); // All set. Now show the data.
        }
        oXHR.onreadystatechange = reportStatus;
        oXHR.open("GET", "playlistL1.json", true); // true = ASYNCHRONOUS REQUEST (DESIRABLE), false = SYNCHRONOUS REQUEST.
        oXHR.send();

        function showTheList(json) {
          files = JSON.parse(json); // Fill JSON data into the files array.
        }
      }
    }


    //Function for the Correct/Incorrect buttons
    document.getElementById("IC").addEventListener("click", function() {
      if (appState === 2) {
        var output = document.getElementById("modalContent");
        output.innerHTML = "You clicked 'INCORRECT'";
        modal.style.display = "block";
      } else {
        buttonClicked(0); //stop the timer; update variables
      }
    });

    //Warn the user if back, close, or refresh is attempted
    window.addEventListener("beforeunload", function(e) {
      var confirmationMessage = 'It looks like you have been editing something. ' +
        'If you leave before saving, your changes will be lost.';

      (e || window.event).returnValue = confirmationMessage; //Gecko + IE
      return confirmationMessage; //Gecko + Webkit, Safari, Chrome etc.
    });

    //Function for the Correct/Incorrect buttons
    document.getElementById("C").addEventListener("click", function() {
      if (appState === 2) {
        var output = document.getElementById("modalContent");
        output.innerHTML = "You clicked 'CORRECT'";
        modal.style.display = "block";
      } else {
        buttonClicked(1); //stop the timer; update variables
      }
    });

    //Functions for the Continue button
    document.getElementById("CONTINUE").addEventListener("click", function() {
      Hide("Frame4"); // hide the CONTINUE button so usr can't keep clicking
      Hide("Frame7"); //hide the reaction time output
      Hide("Frame8"); // hide the Progress bar
      Hide("Frame6"); // hide the confidence slider
      if (appState === 1) { //special conditions for the Stage 1
        handleIt(fname.value);
      } else if (appState === 2) { //special conditions for the Stage 1
        ShowStage(3); //Set up the stage for the next part (Reaction Time test)
      } else if (strType === "beep") {
        cueAudio();
        playAudio();
      } else {
        if (i === files.rows.length - 1) { //if it's the last sentence, report and move to Stage 8
          report();
          ShowStage(9);
          return;
        }
        cueAudio();
        playAudio();
      }
    });

    //Functions for the Continue button
    document.getElementById("START").addEventListener("click", function() {
      if (i === beepfiles.length - 1) { //if it's the last beep, move to Stage 6
        report(); //report the results
        strType = "sentences"; //go to the real sentences
        i = 0; //reset the counter
        audio.src = files.rows[i].path;
        audio.loop = false;
        playAudio();
      }
      playAudio();
    });

    // What happens when usr clicks C or IC
    function buttonClicked(int) {
      clickedTime = Date.now(); //stop the timer
      reactionTime = (clickedTime - createdTime) / 1000; //update the RT variable
      var output = document.getElementById("RTdemo"); //report RT to usr
      output.innerHTML = reactionTime * 1000;
      clickedButton = int; //update the clickedbtn variable

      if (strType === "beep") { //If we're still in the RT test
        if (i === beepfiles.length - 1) {
          ShowStage(6);
        } else {
          ShowStage(5);
        }
      } else {
        if (int === files.rows[i].correct) { //user got it right
          score = 1;
          runningTotal = runningTotal + 1; //add to total score;
        } else { //user got it wrong; add to the list
          score = 0;
          gotWrong[i] = files.rows[i].ID
        }
        ShowStage(8);
      }
    }


    //set the stage for the next thing and play the item
    function playAudio() {
      if (strType === "beep") {
        sentenceStr = beepfiles[i]; //load the filename into the sentenceStr variable
        beepaudio.play(); //Play the audio
        beepaudio.onended = function() { //once the audio ends
          ShowStage(4);
          createdTime = Date.now(); //set the start time
        }
      } else {
        sentenceStr = files.rows[i].path; //load the filename into the sentenceStr variable
      }
      audio.play(); //Play the audio
      audio.onended = function() { //once the audio ends
        ShowStage(4);
        createdTime = Date.now(); //set the start time
      }
    }


    //Cue up the next audio file
    function cueAudio() { //move to the next audio file
      report(); //report results
      if (strType === "beep") { // Check for last audio file in the practice playlist
        if (i === beepfiles.length - 1) { //see if we've reached the last practice item
          strType = "sentences"; //go to the real sentences
          i = 0;
          audio.src = files.rows[i].path;
          return;
        } else {
          i++; //go to the next audio
          beepaudio.src = beepfiles[i];
        }
      } else { //We're in the real sentences
        if (i !== files.rows.length - 1) { //see if we've reached the last  item
          i++; //go to the next audio
          audio.src = files.rows[i].path;
          updateProgress(); //update the progress bar
        }
      }
    }

    //Function to order Divs on the stage
    function swapSibling(div1, div2) { //reorders two divs
      var parent = div1.parentNode;
      parent.insertBefore(div2, div1);
    }


    // Show or hide the various DIVs as needed
    function ShowStage(Showint) {
      if (Showint === 2) { //the instruction screen
        Hide("Frame1"); //hides the Intro screen
        Show("Frame2"); //shows the instructions blurb
        Show("Frame2.5"); //shows the C/IC buttons
        Show("Frame6"); //shows the confidence slider
        Show("Frame4"); // hide the CONTINUE button//
        //Re-order the divs
        swapSibling(document.getElementById('Frame4'), document.getElementById('Frame6'));
        appState = 2;

      } else if (Showint === 3) { //the RT test screen
        Hide("Frame2"); //hides the instructions blurb
        Hide("Frame2.5"); //hides the C/IC buttons
        Hide("Frame6"); //hides the confidence slider
        Hide("Frame4"); // hide the CONTINUE button
        Show("Frame3"); //shows the RT instructions blurb
        Show("Frame3.5"); // show the START button
        appState = 3;

      } else if (Showint === 4) { //the RT test C/IC button screen
        Hide("Frame4"); // hide the CONTINUE button
        Hide("Frame3.5"); // hide the START button
        Hide("Frame8"); // hide the Progress bar button
        Hide("Frame6"); // hide the confidence slider
        Hide("Frame7"); //show the reaction time output
        Show("Frame2.5"); //shows the C/IC buttons
        if (strType === "beep") {
          Show("Frame3"); //shows the RT instructions blurb
          Hide("Frame9"); //hide the sentences instructions blurb
        } else {
          Hide("Frame3"); //shows the RT instructions blurb
          Show("Frame9"); //show the sentences instructions blurb
        }
        //Re-order the divs
        swapSibling(document.getElementById('Frame2.5'), document.getElementById('Frame3'));
        swapSibling(document.getElementById('Frame2.5'), document.getElementById('Frame9'));
        appState = 4;

      } else if (Showint === 5) { //the RT test screen showing RT
        Hide("Frame2.5"); //hides the C/IC buttons
        Show("Frame4"); // show the CONTINUE button
        Show("Frame7"); //show the reaction time output
        appState = 5;

      } else if (Showint === 6) {
        if (i === beepfiles.length - 1) {
          Show("Frame3.5"); // show the CONTINUE button
        } else {
          Show("Frame4"); // show the START button
        }
        Hide("Frame3"); //shows the RT instructions blurb
        Hide("Frame2.5"); //hides the C/IC buttons
        Show("Frame9"); //show the sentences instructions blurb
        Show("Frame7"); //show the reaction time output
        //Re-order the divs
        swapSibling(document.getElementById('Frame3.5'), document.getElementById('Frame9'));
        swapSibling(document.getElementById('Frame4'), document.getElementById('Frame9'));
        swapSibling(document.getElementById('Frame7'), document.getElementById('Frame3.5'));
        swapSibling(document.getElementById('Frame7'), document.getElementById('Frame4'));
        appState = 6;

      } else if (Showint === 8) { //show the confidence slider
        document.getElementById("myRange2").value = 50;
        var output = document.getElementById("demo2");
        output.innerHTML = slider.value;
        // document.getElementById("demo2").value = "50";
        Hide("Frame2.5"); //hides the C/IC buttons
        Show("Frame7"); //show the reaction time output
        updateProgress();
        Show("Frame8"); // show the Progress bar
        // Hide("Frame9"); //show the sentences instructions blurb
        Show("Frame6"); // show the confidence slider
        Show("Frame4"); // show the CONTINUE button
        appState = 7;

      } else if (Showint === 9) {
        showSentences();
        Hide("Frame2.5"); //hides the C/IC buttons
        Hide("Frame9"); //hide the sentences instructions blurb
        Show("Frame10"); // show the feedback page
      }
    }

    //Function to deal with the input items on the first stage
    function handleIt(text) {
      if (text + "" == "") { //Check that "text" is not null
        var output = document.getElementById("modalContent");
        output.innerHTML = "Please enter a name."; //alert the usr
        modal.style.display = "block";
        Show("Frame4"); // show the CONTINUE button so usr can't keep clicking
        return;
      } else { //check radio has been selected
        var checked_radio = document.querySelector('input[name = "NSRadio"]:checked');
        if (checked_radio != null) { //Test if something was checked
          strStatus = checked_radio.value; //update the strStatus variable
        } else {
          var output = document.getElementById("modalContent");
          output.innerHTML = "Do you consider yourself a NATIVE SPEAKER of English?<BR>Please indicate Yes or No."; //alert the usr
          modal.style.display = "block";
          Show("Frame4"); // show the CONTINUE button so usr can't keep clicking
          return;
        };
        strUser = text; //set the strUser variable
        ShowStage(2); //Set up the stage for the next part (explanation of the test and controls)
      }
    }

    //Function to test the sound - ensure that user's sound is on
    function testSound() {
      beep.src = "TestSounds/test1.mp3"
      beep.loop = false;
      beep.volume = 0.1;
      beep.play();
      document.getElementById("TestSoundButton").disabled = true; // Disable the button while it's making the sound - otherwise, users can keep clicking
      document.getElementById("TestSoundButton").src = "testsound0002.png"; //change image while sound is playing
      beep.onended = function() { //When sound ends
        document.getElementById("TestSoundButton").src = "testsound0001.png"; // change the iamge back
        document.getElementById("TestSoundButton").disabled = false; // Enable the button again
      };
    }


    //slider functions
    var slider = document.getElementById("myRange2");
    var output = document.getElementById("demo2");
    output.innerHTML = slider.value;

    //get a value from the slider
    slider.onpointerup = function() {
      output.innerHTML = this.value;
    }

    //Hide a block
    function Hide(strFrame) {
      var x = document.getElementById(strFrame);
      x.style.display = "none";
    }

    //Show a block
    function Show(strFrame) {
      var x = document.getElementById(strFrame);
      x.style.display = "block";
    }

    //Update the Progress bar
    function updateProgress() {
      var elem = document.getElementById("myBar");
      var width = (i + 1) / files.rows.length;
      // if (i >= files.rows.length) { //It's the end of the test!
      //   i = 0;
      // } else {
      elem.style.width = width * 100 + "%";
      var output = document.getElementById("prog");
      output.innerHTML = (i + 1) + " out of " + files.rows.length;
      // }
    }

    // Get the modal (pop-up) message used in stage 2
    var modal = document.getElementById("myModal");

    // Get the <span> element that closes the modal
    var span = document.getElementsByClassName("close")[0];

    // When the user clicks on <span> (x), close the modal
    span.onclick = function() {
      modal.style.display = "none";
    }

    function showExplanation(spanID) { //so usr can click on a sentence and see an explanation
      var output = document.getElementById("explanation");
      output.innerHTML = files.rows[spanID].explanation; //show the explanation in the explantion box
      selectedSentence = spanID;
    }

    function showSentences() {
      var outputScore = document.getElementById("totalScore"); //report total score to user
      outputScore.innerHTML = runningTotal + " out of " + files.rows.length;
      var outputFB = document.getElementById("feedback"); //report which sentence s/he got wrong
      if (gotWrong.length === 0) { //the user made no mistakes
        outputFB.innerHTML = "Congratulations!"
      } else {
        var showMistakes = ""
        for (var x = 0; x <= files.rows.length - 1; x++) { //loop through the gotWrong array and display results
          if (gotWrong[x] === files.rows[x].ID) {
            showMistakes = showMistakes + ", " + gotWrong[x];
          }
          var trim = showMistakes.replace(/(^,)|(,$)/g, "")
          outputFB.innerHTML = "You chose the wrong answer for sentences " + trim;
        }
      }
      for (var c = 0; c <= files.rows.length - 1; c++) { //Fill the slider box with the sentences
        var span = document.getElementById(c + 1);
        span.innerText = files.rows[c].ID + ". " + files.rows[c].text;
        if (gotWrong[c] === files.rows[c].ID) {
          document.getElementById(c + 1).style.color = "red";
        }
      }
    }


    function playItAgain() { //play the audio for selected sentence
      if (selectedSentence === 50) { //If the user hasn't selected a sentence yet
        var output = document.getElementById("explanation");
        output.style.color = "red";
        output.innerHTML = "Please select a sentence from the list above.";
        return;
      } else {
        var output = document.getElementById("explanation");
        output.style.color = "black";
      }
      again.src = files.rows[selectedSentence].path
      again.loop = false;
      again.play();
      document.getElementById("playagain").disabled = true; // Disable the button while it's playing the sentence- otherwise, users can keep clicking
      document.getElementById("playagain").src = "pause.png"; //change image while sound is playing
      again.onended = function() { //When sound ends
        document.getElementById("playagain").src = "play.png"; // change the iamge back
        document.getElementById("playagain").disabled = false; // Enable the button again

      }
    }
  </script>
</body>

</html>
